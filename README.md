## Разработка PowerShell - скриптов

ОПИСАНИЕ основного скрипта Поиск ПО:
Скрипт предназначен для сбора информации об установленном программном обеспечении на компьютерах домена Active Directory.
Он анализирует время последнего использования ПО, формирует отчеты и отправляет их пользователям и администратору.

ФУНКЦИОНАЛЬНЫЕ ВОЗМОЖНОСТИ:
1. Сбор данных об установленном ПО через различные методы:
   - Анализ системного реестра
   - Запросы WMI/CIM
   - Анализ Prefetch-файлов
   - Чтение журналов событий
2. Определение времени последнего запуска ПО
3. Категоризация ПО по времени использования:
   - Не использовалось более полугода
   - Не использовалось от 3 до 6 месяцев
   - Использовалось в течение последних 3 месяцев
4. Автоматическое получение информации о пользователях из Active Directory
5. Формирование подробных отчетов в форматах CSV и HTML
6. Рассылка отчетов:
   - Пользователям: только данные по их компьютерам
   - Администратору: полный отчет
7. Гибкие настройки:
   - Возможность исключения пользователей из рассылки
   - Выбор методов сбора данных
   - Настройка параметров SMTP-сервера
   - Тестовый режим работы

ЭЛЕМЕНТЫ ГРАФИЧЕСКОГО ИНТЕРФЕЙСА:

1. Основные параметры:
   - Домен: имя домена Active Directory
   - Пользователь с правами: учетная запись с административными правами для доступа к компьютерам
   - Пароль: пароль для указанной учетной записи

2. Настройки электронной почты:
   - SMTP сервер: адрес почтового сервера для отправки отчетов
   - Отправитель: email адрес отправителя
   - Email администратора: адрес для отправки полного отчета
   - Флажок "Отправлять отчеты по email": включает/выключает рассылку

3. Дополнительные параметры:
   - Исключить пользователей: список пользователей (через запятую), которые не получат отчеты
   - Методы сбора данных: выбор методов для получения информации о ПО
   - Тестовый режим: ограничивает обработку первыми тремя компьютерами

КАК УКАЗАТЬ ПОЛЬЗОВАТЕЛЕЙ ДЛЯ ИСКЛЮЧЕНИЯ ИЗ РАССЫЛКИ:
1. В поле "Исключить пользователей" введите имена пользователей через запятую
2. Используйте SAMAccountName (имя для входа в систему)
3. Пример: ServiceAccount1,TestUser,BackupAdmin
4. Эти пользователи не получат email с отчетом о ПО на их компьютерах

ПОДДЕРЖИВАЕМЫЕ МЕТОДЫ ПОДКЛЮЧЕНИЯ К КОМПЬЮТЕРАМ:
Скрипт автоматически пробует несколько методов подключения к удаленным компьютерам:
1. WMI (Windows Management Instrumentation)
2. CIM (Common Information Model)
3. Прямой доступ к реестру через удаленный API
4. Анализ общих сетевых ресурсов (административные общие ресурсы)

Если один метод не срабатывает, скрипт автоматически пробует следующий метод.

ЛОГИРОВАНИЕ:
- Все действия скрипта записываются в лог-файл
- Лог отображается в отдельном окне в режиме реального времени
- После завершения работы скрипта лог-файл сохраняется на диске

================================================================================================================
"@
